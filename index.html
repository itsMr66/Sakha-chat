<!DOCTYPE html>
<html lang="en">
<head>
  <base href="https://sakha.ai">
  <title>Sakha - Your Spiritual Friend</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* Add your CSS styles here */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f0f0f0;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    .chat-container {
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .chat-header {
      background-color: #4a90e2;
      color: #fff;
      padding: 10px;
      display: flex;
      align-items: center;
    }
    .chat-messages {
      height: 400px;
      overflow-y: auto;
      padding: 20px;
    }
    .message {
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 5px;
    }
    .user-message {
      background-color: #e6f3ff;
      text-align: right;
    }
    .bot-message {
      background-color: #f0f0f0;
    }
    .chat-input {
      display: flex;
      padding: 10px;
    }
    .chat-input input {
      flex-grow: 1;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .chat-input button {
      background-color: #4a90e2;
      color: #fff;
      border: none;
      padding: 10px 20px;
      margin-left: 10px;
      border-radius: 5px;
      cursor: pointer;
    }
    .topics {
      display: flex;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }
    .topic-bullet {
      background-color: #4a90e2;
      color: #fff;
      padding: 5px 10px;
      margin: 5px;
      border-radius: 20px;
      cursor: pointer;
    }
    .spiritual-particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }
    .particle {
      position: absolute;
      background-color: rgba(74, 144, 226, 0.3);
      border-radius: 50%;
      animation: float 5s infinite ease-in-out;
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }
    .activity-section, .info-section {
      margin-top: 20px;
    }
    .activity-card, .info-card {
      background-color: #fff;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 10px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    .navigation {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background-color: #fff;
      display: flex;
      justify-content: space-around;
      padding: 10px 0;
      box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
    }
    .nav-item {
      text-decoration: none;
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .nav-item i {
      font-size: 24px;
      margin-bottom: 5px;
    }
    .notification-icon, .history-icon {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: #4a90e2;
      color: #fff;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
    }
    .history-icon {
      right: 70px;
    }
    .notification-panel, .history-panel {
      position: fixed;
      top: 70px;
      right: 20px;
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      padding: 20px;
      display: none;
    }
    .chanting-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8);
      display: none;
      justify-content: center;
      align-items: center;
      color: #fff;
      font-size: 24px;
    }
    .close-overlay {
      position: absolute;
      top: 20px;
      right: 20px;
      background: none;
      border: none;
      color: #fff;
      font-size: 24px;
      cursor: pointer;
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <div class="spiritual-particles" id="particles"></div>
  <div class="container" id="appContainer">
    <div class="logo"><img src="https://www.sakha.chat/logo.png" alt="Sakha Logo"></div>
    <div class="welcome-message" id="welcomeMessage"></div>
    <div class="chat-container" id="chatContainer">
      <div class="chat-header"><button class="back-button" onclick="goBack()"><i class="fas fa-arrow-left"></i></button><span id="chatHeaderText">Hare Krishna Nilesh</span></div>
      <div class="chat-messages" id="chatMessages">
        <div class="message bot-message">Namaste! I'm Sakha, your spiritual friend. How can I guide you today?<div class="message-actions"><button class="message-action" onclick="likeMessage(this)"><i class="fas fa-thumbs-up"></i></button><button class="message-action" onclick="dislikeMessage(this)"><i class="fas fa-thumbs-down"></i></button><button class="message-action" onclick="copyMessage(this)"><i class="fas fa-copy"></i></button></div>
        </div>
      </div>
      <div class="topics" id="topics">
        <div class="topic-bullet" onclick="selectTopic('Anxiety')">Anxiety</div>
        <div class="topic-bullet" onclick="selectTopic('Depression')">Depression</div>
        <div class="topic-bullet" onclick="selectTopic('Mindfulness')">Mindfulness</div>
        <div class="topic-bullet" onclick="selectTopic('Spirituality')">Spirituality</div>
        <div class="topic-bullet" onclick="selectTopic('Meditation')">Meditation</div>
      </div>
      <div class="chat-input-container">
        <div class="typing-indicator" id="typingIndicator">
          <div class="dot"></div>
          <div class="dot"></div>
          <div class="dot"></div>
        </div>
        <div class="chat-input"><input type="text" id="userInput" placeholder="Type your message here..."><button onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button></div>
      </div>
    </div>
    <div class="activity-section">
      <h2>Your Spiritual Journey</h2>
      <div class="activity-cards">
        <div class="activity-card" id="chantingCard">
          <div class="activity-info">
            <div class="activity-title"><i class="fas fa-om"></i>Chanting</div><button class="activity-button" onclick="completeActivity('chanting')">Complete Chanting</button>
          </div>
          <div class="progress-circle" data-progress="0"></div>
        </div>
        <div class="activity-card" id="readingCard">
          <div class="activity-info">
            <div class="activity-title"><i class="fas fa-book"></i>Reading</div><button class="activity-button" onclick="completeActivity('reading')">Complete Reading</button>
          </div>
          <div class="progress-circle" data-progress="0"></div>
        </div>
        <div class="activity-card" id="gameStreakCard">
          <div class="activity-info">
            <div class="activity-title"><i class="fas fa-gamepad"></i>Game Streak</div><button class="activity-button" onclick="completeActivity('gameStreak')">Complete Game</button>
          </div>
          <div class="progress-circle" data-progress="0"></div>
        </div>
      </div>
    </div>
    <div class="info-section">
      <h2>Spiritual Insights</h2>
      <div class="info-cards">
        <div class="info-card">
          <div class="info-title"><i class="fas fa-bullhorn"></i> Announcements</div>
          <div class="info-content">Join us for a special meditation session this Sunday at 10 AM IST.</div>
        </div>
        <div class="info-card">
          <div class="info-title"><i class="fas fa-book-open"></i> Shloka of the Day</div>
          <div class="info-content">"Yogaḥ karmasu kauśalam" - Yoga is skill in action. (Bhagavad Gita 2.50)</div>
        </div>
        <div class="info-card" style="margin-bottom: 10vh;">
          <div class="info-title"><i class="fas fa-newspaper"></i> Spiritual News</div>
          <div class="info-content">New study shows regular meditation can significantly reduce stress levels.</div>
        </div>
      </div>
    </div>
  </div>
  <nav class="navigation">
    <a href="#" class="nav-item nav-active"><i class="fas fa-home"></i><span>Home</span></a>
    <a href="#" class="nav-item"><i class="fas fa-book"></i><span>Books</span></a>
    <a href="https://sakha-five.vercel.app/mala.html" class="nav-item"><i class="fas fa-om"></i><span>Chanting</span></a>
    <a href="#" class="nav-item"><i class="fas fa-leaf"></i><span>Remedies</span></a>
    <a href="#" class="nav-item"><i class="fas fa-gamepad"></i><span>Game</span></a>
  </nav>
  <div class="notification-icon" onclick="toggleNotifications()" data-count="3"><i class="fas fa-bell"></i></div>
  <div class="notification-panel" id="notificationPanel">
    <div class="notification-panel-header">
      <h2 class="notification-panel-title">Notifications</h2><button class="close-notification-panel" onclick="toggleNotifications()"><i class="fas fa-times"></i></button>
    </div>
    <div class="notification-item">
      <div class="notification-item-title">New Meditation Technique</div>
      <div class="notification-item-content">Explore our latest guided meditation for inner peace.</div>
    </div>
    <div class="notification-item">
      <div class="notification-item-title">Chanting Milestone</div>
      <div class="notification-item-content">Your friend Radha has completed a 7-day chanting streak!</div>
    </div>
    <div class="notification-item">
      <div class="notification-item-title">New Spiritual Article</div>
      <div class="notification-item-content">"Finding Peace in Chaos" - Read our latest blog post.</div>
    </div>
  </div>
  <div class="history-icon" onclick="toggleHistory()"><i class="fas fa-history"></i></div>
  <div class="history-panel" id="historyPanel">
    <div class="history-panel-header">
      <h2 class="history-panel-title">Conversation History</h2><button class="close-history-panel" onclick="toggleHistory()"><i class="fas fa-times"></i></button>
    </div>
    <div class="history-item">
      <div class="history-item-title">Meditation Techniques</div>
      <div class="history-item-content">Discussion about various meditation techniques and their benefits.</div>
    </div>
    <div class="history-item">
      <div class="history-item-title">Understanding Karma</div>
      <div class="history-item-content">Exploring the concept of karma and its impact on our lives.</div>
    </div>
    <div class="history-item">
      <div class="history-item-title">Bhagavad Gita Insights</div>
      <div class="history-item-content">Key teachings from the Bhagavad Gita and their modern applications.</div>
    </div>
  </div>
  <div class="chanting-overlay" id="chantingOverlay">
    <h1>Hare Krishna</h1><button class="close-overlay" onclick="closeChantingOverlay()"><i class="fas fa-times"></i></button>
  </div>
<script>
  async function sendMessage() {
    const userInput = document.getElementById('userInput');
    const chatMessages = document.getElementById('chatMessages');
    const typingIndicator = document.getElementById('typingIndicator');
    const topics = document.getElementById('topics');
    const chatHeaderText = document.getElementById('chatHeaderText');
    const notificationIcon = document.querySelector('.notification-icon');
    const historyIcon = document.querySelector('.history-icon');

    if (userInput.value.trim() !== '') {
      enterFullscreenMode();

      document.querySelector('.logo').style.display = 'none';
      document.querySelector('.welcome-message').style.display = 'none';
      document.querySelector('.activity-section').style.display = 'none';
      document.querySelector('.info-section').style.display = 'none';
      topics.style.display = 'none';
      notificationIcon.style.display = 'none';
      historyIcon.style.display = 'flex';

      chatHeaderText.textContent = 'Sakha';

      const userMessage = document.createElement('div');
      userMessage.className = 'message user-message';
      userMessage.textContent = userInput.value;
      chatMessages.appendChild(userMessage);

      const userPrompt = userInput.value;
      userInput.value = '';

      typingIndicator.classList.add('active');
      typingIndicator.style.animation = 'pulse 1s infinite';

      try {
        const response = await fetch('/api/chat', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ prompt: userPrompt })
        });
        const data = await response.json();

        typingIndicator.classList.remove('active');
        typingIndicator.style.animation = '';

        const botMessage = document.createElement('div');
        botMessage.className = 'message bot-message';

        if (data.choices && data.choices[0] && data.choices[0].message) {
          const botResponse = data.choices[0].message.content;

          const words = botResponse.split(' ');
          words.forEach((word, index) => {
            const span = document.createElement('span');
            span.className = 'word';
            span.textContent = word + ' ';
            span.style.animationDelay = `${index * 0.1}s`;
            botMessage.appendChild(span);
          });

          const messageActions = document.createElement('div');
          messageActions.className = 'message-actions';
          messageActions.innerHTML = `
            <button class="message-action" onclick="likeMessage(this)"><i class="fas fa-thumbs-up"></i></button>
            <button class="message-action" onclick="dislikeMessage(this)"><i class="fas fa-thumbs-down"></i></button>
            <button class="message-action" onclick="copyMessage(this)"><i class="fas fa-copy"></i></button>
          `;
          botMessage.appendChild(messageActions);

          chatMessages.appendChild(botMessage);
          chatMessages.scrollTop = chatMessages.scrollHeight;

          addToHistory('API Response', botResponse.substring(0, 50) + '...');
        } else {
          botMessage.textContent = "I apologize, but I couldn't generate a response at this time. Please try again.";
          chatMessages.appendChild(botMessage);
        }
      } catch (error) {
        console.error('Error:', error);
        const errorMessage = document.createElement('div');
        errorMessage.className = 'message bot-message error-message';
        errorMessage.textContent = "I'm sorry, but there was an error processing your request. Please try again later.";
        chatMessages.appendChild(errorMessage);
      }
    }
  }

  function likeMessage(button) {
    button.classList.toggle('active');
    // Add like functionality
  }

  function dislikeMessage(button) {
    button.classList.toggle('active');
    // Add dislike functionality
  }

  function copyMessage(button) {
    const message = button.closest('.message').textContent;
    navigator.clipboard.writeText(message).then(() => {
      // Show a tooltip or notification that the message was copied
    });
  }

  // Other functions (completeActivity, openChantingOverlay, closeChantingOverlay, goBack, enterFullscreenMode, toggleNotifications, toggleHistory, updateNavigationVisibility, scrollChatToBottom, addToHistory, typeWriter, createParticles) remain the same.

  typeWriter();
  createParticles();

  document.getElementById('userInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      sendMessage();
    }
  });

  window.addEventListener('scroll', () => {
    const particles = document.querySelectorAll('.particle');
    const scrollPosition = window.pageYOffset;
    particles.forEach((particle, index) => {
      const speed = 0.5 + (index / particles.length) * 0.5;
      particle.style.transform = `translateY(${scrollPosition * speed}px)`;
    });
  });
</script>
</body>
</html>